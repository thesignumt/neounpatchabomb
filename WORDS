_G.wordbomb = {}
_G.wordbomb.used = _G.wordbomb.used or {}

loadstring(game:HttpGet("https://raw.githubusercontent.com/sigmacodeslol/neounpatchabomb/refs/heads/master/englishwords"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/sigmacodeslol/neounpatchabomb/refs/heads/master/periodictable"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/sigmacodeslol/neounpatchabomb/refs/heads/master/longwords"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/sigmacodeslol/neounpatchabomb/refs/heads/master/MUSTUSE"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/sigmacodeslol/neounpatchabomb/refs/heads/master/hyphens"))()

function merge_lists(...)
	local merged_list = {}
	local seen = {}
	for _, list in ipairs({ ... }) do
		for _, item in ipairs(list) do
			if not seen[item] then
				table.insert(merged_list, item)
				seen[item] = true
			end
		end
  end
	return merged_list
end


local wb = _G.wordbomb
wb.small = merge_lists(wb.ENGLISH_WORDS, wb.MUSTUSE, wb.PERIODIC, wb.LONGW, wb.HYPHENATED)
wb.long = merge_lists(wb.LONGW, wb.MUSTUSE, wb.HYPHENATED, wb.ENGLISH_WORDS, wb.PERIODIC)
wb.hyphen = merge_lists(wb.HYPHENATED, wb.LONGW, wb.MUSTUSE, wb.PERIODIC, wb.ENGLISH_WORDS)
wb.current = wb.small

function wb.wb(dname)
	local valid = {"small", "long", "hyphen"}

	-- ensure it's a string and one of the valid names
	local name = nil
	if type(dname) ~= "string" or not wb.has(dname, valid) then
		print('⚠️ dname must be either "small", "long", or "hyphen"')
		return
	end

	-- safe assignment
	wb.current = wb[name or dname]
	print("✅ wb.current set to wb." .. name or dname)
end

function wb.has(value, list)
    list = list or wb.used
    for _, v in ipairs(list) do
        if v == value then
            return true
        end
    end
    return false
end

function wb.find(str)
	local hyphen = string.sub(str, 1, 1) == "-"
	if hyphen == true then
		local str = string.sub(str, 2)
	end

	local found = nil
	local d = hyphen == true and wb.hyphen or wb.current
	for _, v in ipairs(d) do
		if
			string.find(v, string.lower(str))
			and not wb.has(v)
		then
			found = v
			table.insert(wb.used, v)
			break
		end
	end
	return found
end

return { find = wb.find, set_dict = wb.wb }
